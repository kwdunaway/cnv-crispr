main="Pie Chart of Countries")
pie(slices,labels = lbls, col=rainbow(4),
main="Pie Chart of Countries")
pie(sections,labels = labs, col=rainbow(4),
main="Pie Chart of Countries")
sections = c(piedata[2,3:5],piedata$freq[1]+piedata$freq[2]+piedata$freq[6])
labs = c("2x", "3x", "4x", "Other")
pie(sections,labels = labs, col=rainbow(4),
main="Pie Chart of Countries")
sections = c(piedata$freq[3:5],piedata$freq[1]+piedata$freq[2]+piedata$freq[6])
labs = c("2x", "3x", "4x", "Other")
pie(sections,labels = labs, col=rainbow(4),
main="Pie Chart of Countries")
sections = c(piedata$freq[3:5],piedata$freq[1]+piedata$freq[2]+piedata$freq[6])
labs = c("2x", "3x", "4x", "Other")
pct <- round(sections/sum(sections*100)
labs <- paste(labs, pct) # add percents to labels
labs <- paste(labs,"%",sep="") # ad % to labels
sections = c(piedata$freq[3:5],piedata$freq[1]+piedata$freq[2]+piedata$freq[6])
labs = c("2x", "3x", "4x", "Other")
pct <- round(sections/sum(sections*100))
labs <- paste(labs, pct) # add percents to labels
labs <- paste(labs,"%",sep="") # ad % to labels
pie(sections,labels = labs, col=rainbow(4),
main="Pie Chart of Countries")
sections
sections/sum(sections*100
)
pct <- round(sections/sum(sections)*100)
pct <- round(sections/sum(sections)*100,digits = 4)
pct <- round(sections/sum(sections)*100,digits = 2)
sections = c(piedata$freq[3:5],piedata$freq[1]+piedata$freq[2]+piedata$freq[6])
labs = c("2x", "3x", "4x", "Other")
pct <- round(sections/sum(sections)*100,digits = 2)
labs <- paste(labs, pct) # add percents to labels
labs <- paste(labs,"%",sep="") # ad % to labels
pie(sections,labels = labs, col=rainbow(4),
main="Pie Chart of Countries")
pct <- round(sections/sum(sections)*100,digits = 1)
labs <- paste(labs, pct) # add percents to labels
labs <- paste(labs,"%",sep="") # ad % to labels
pie(piedata$freq,labels=piedata$x,col=rainbow(length(piedata)),
main="Pie Chart of Countries ")
pie(sections,labels = labs, col=rainbow(4),
main="Pie Chart of Countries")
sections = c(piedata$freq[3:5],piedata$freq[1]+piedata$freq[2]+piedata$freq[6])
labs = c("2x", "3x", "4x", "Other")
pct <- round(sections/sum(sections)*100,digits = 1)
labs <- paste(labs, pct) # add percents to labels
labs <- paste(labs,"%",sep="") # ad % to labels
pie(sections,labels = labs, col=rainbow(4),
main="Pie Chart of Countries")
sections = c(piedata$freq[3:5],piedata$freq[1]+piedata$freq[2]+piedata$freq[6])
labs = c("2x", "3x", "4x", "Other")
pct <- round(sections/sum(sections)*100,digits = 1)
labs <- paste(labs,":", pct,"%",sep="") # ad % to labels
pie(sections,labels = labs, col=rainbow(4),
main="Pie Chart of Countries")
```
piedata = count(CNVtable$CNVcount)
sections = c(piedata$freq[3:5],piedata$freq[1]+piedata$freq[2]+piedata$freq[6])
labs = c("2x", "3x", "4x", "Other")
pct <- round(sections/sum(sections)*100,digits = 1)
pie(sections,labels = labs, col=rainbow(4),main="Breakdown of probe Ploidy in A375")
piedata = count(CNVtable$CNVcount)
sections = c(piedata$freq[3:5],piedata$freq[1]+piedata$freq[2]+piedata$freq[6])
labs = c("2x", "3x", "4x", "Other")
pct <- round(sections/sum(sections)*100,digits = 1)
labs <- paste(labs,":", pct,"%",sep="") # ad % to labels
pie(sections,labels = labs, col=rainbow(4),main="Breakdown of probe Ploidy in A375")
CNVload = read.table("data/CNV_guide_table.tsv", header = TRUE, sep = "\t")
process_CNV_table = function(df){
df$Ratio_D7R1 = df$norm_count_D7_Rep1/df$norm_count_plasmid
df$Ratio_D7R2 = df$norm_count_D7_Rep2/df$norm_count_plasmid
df$Ratio_D14R1 = df$norm_count_D14_Rep1/df$norm_count_plasmid
df$Ratio_D14R2 = df$norm_count_D14_Rep2/df$norm_count_plasmid
df$Ratio_PLX7R1 = df$norm_count_PLX7_Rep1/df$norm_count_plasmid
df$Ratio_PLX7R2 = df$norm_count_PLX7_Rep2/df$norm_count_plasmid
df$Ratio_PLX14R1 = df$norm_count_PLX14_Rep1/df$norm_count_plasmid
df$Ratio_PLX14R2 = df$norm_count_PLX14_Rep2/df$norm_count_plasmid
df$Ratio_D7 = (df$norm_count_D7_Rep1+df$norm_count_D7_Rep2)/(2*df$norm_count_plasmid)
df$Ratio_D14 = (df$norm_count_D14_Rep1+df$norm_count_D14_Rep2)/(2*df$norm_count_plasmid)
df$Ratio_PLX7 = (df$norm_count_PLX7_Rep1+df$norm_count_PLX7_Rep2)/(2*df$norm_count_plasmid)
df$Ratio_PLX14 = (df$norm_count_PLX14_Rep1+df$norm_count_PLX14_Rep2)/(2*df$norm_count_plasmid)
return(df)
}
CNVtable = process_CNV_table(CNVload)
CNVtable = subset(CNVtable, CNVcount > 1 & CNVcount < 4)
sum(CNVtable$OS > 400)
sum(CNVtable$OS <= 400)
CNVload = read.table("data/CNV_guide_table.tsv", header = TRUE, sep = "\t")
CNVtable = process_CNV_table(CNVload)
CNVtable_23x = subset(CNVtable, CNVcount > 1 & CNVcount < 4)
sections = c(sum(CNVtable$OS > 400),piedata$freq[1]+piedata$freq[2]+piedata$freq[6])
labs = c(">400", "<=400")
pct <- round(sections/sum(sections)*100,digits = 1)
labs <- paste(labs,":", pct,"%",sep="")
pie(sections,labels = labs, col=rainbow(2),main="Ploidy of sgRNAs in A375 cell line")
sections = c(sum(CNVtable$OS > 400),sum(CNVtable$OS <= 400))
labs = c(">400", "<=400")
pct <- round(sections/sum(sections)*100,digits = 1)
labs <- paste(labs,":", pct,"%",sep="")
pie(sections,labels = labs, col=rainbow(2),main="Ploidy of sgRNAs in A375 cell line")
#Code found at http://www.statmethods.net/graphs/pie.html
sections = c(sum(CNVtable$OS > 400),sum(CNVtable$OS <= 400))
labs = c(">400", "<=400")
pct <- round(sections/sum(sections)*100,digits = 1)
labs <- paste(labs,":", pct,"%",sep="")
pie(sections,labels = labs, col=("blue","red"),main="Ploidy of sgRNAs in A375 cell line")
```
sections = c(sum(CNVtable$OS > 400),sum(CNVtable$OS <= 400))
labs = c(">400", "<=400")
pct <- round(sections/sum(sections)*100,digits = 1)
labs <- paste(labs,":", pct,"%",sep="")
pie(sections,labels = labs, col=("blue","red"),main="Ploidy of sgRNAs in A375 cell line")
pie(sections,labels = labs, col=("blue","red"))
pie(sections,labels = labs, col=c("blue","red"))
pie(sections,labels = labs, col=c("blue","red"), main="Ploidy of sgRNAs in A375 cell line")
pie(sections,labels = labs, col=c("blue","red"), main="Ploidy of sgRNAs in A375 cell line")
```
pie(sections,labels = labs, col=c("blue","red"), main="Ploidy of sgRNAs in A375 cell line")
```
pie(sections,labels = labs, col=c("blue","red"), main="Ploidy of sgRNAs in A375 cell line")
sections = c(sum(CNVtable$OS > 400),sum(CNVtable$OS <= 400))
labs = c("OS > 400: ", "OS <= 400: ")
pct <- round(sections/sum(sections)*100,digits = 1)
labs <- paste(labs, pct,"% ", sections,sep="")
pie(sections,labels = labs, col=c("blue","red"), main="Ploidy of sgRNAs in A375 cell line")
sections = c(sum(CNVtable$OS > 400),sum(CNVtable$OS <= 400))
labs = c("OS > 400: ", "OS <= 400: ")
pct <- round(sections/sum(sections)*100,digits = 1)
labs <- paste(labs, pct,"%, ", sections,sep="")
pie(sections,labels = labs, col=c("blue","red"), main="Ploidy of sgRNAs in A375 cell line")
sections = c(sum(CNVtable_23x$OS > 400),sum(CNVtable_23x$OS <= 400))
labs = c("OS > 400: ", "OS <= 400: ")
pct <- round(sections/sum(sections)*100,digits = 1)
labs <- paste(labs, pct,"%, ", sections,sep="")
pie(sections,labels = labs, col=c("blue","red"), main="Ploidy of sgRNAs in A375 cell line")
sections = c(sum(CNVtable$OS > 400),sum(CNVtable$OS <= 400))
labs = c("OS > 400: ", "OS <= 400: ")
pct <- round(sections/sum(sections)*100,digits = 1)
labs <- paste(labs, pct,"%, ", sections,sep="")
pie(sections,labels = labs, col=c("blue","red"), main="Off-target Scores of ALL sgRNAs")
sections = c(sum(CNVtable_23x$OS > 400),sum(CNVtable_23x$OS <= 400))
sections = c(sum(CNVtable_23x$OS > 400),sum(CNVtable_23x$OS <= 400))
labs = c("OS > 400: ", "OS <= 400: ")
pct <- round(sections/sum(sections)*100,digits = 1)
labs <- paste(labs, pct,"%, ", sections,sep="")
pie(sections,labels = labs, col=c("blue","red"), main="Off-target Scores of 2x and 3x ploidy sgRNAs")
pie(sections,labels = labs, col=c("purple","orange"), main="Off-target Scores of ALL sgRNAs")
sections = c(sum(CNVtable_23x$OS > 400),sum(CNVtable_23x$OS <= 400))
pie(sections,labels = labs, col=c("purple","orange"), main="Off-target Scores of 2x and 3x ploidy sgRNAs")
```
OStable = read.table("data/Shalem_2014Table_S1.tsv", header = TRUE, sep = "\t")
View(OStable)
sections = c(sum(OStable$Off.target.score..OS. > 400),sum(OStable$Off.target.score..OS. <= 400))
labs = c("OS > 400: ", "OS <= 400: ")
pct <- round(sections/sum(sections)*100,digits = 1)
labs <- paste(labs, pct,"%, ", sections,sep="")
pie(sections,labels = labs, col=c("purple","orange"), main="Off-target Scores of ALL sgRNAs")
sections = c(sum(CNVtable_23x$OS > 400),sum(CNVtable_23x$OS <= 400))
piedata = count(CNVtable$CNVcount)
sections = c(piedata$freq[3:5],piedata$freq[1]+piedata$freq[2]+piedata$freq[6])
labs = c("OS > 400: ", "OS <= 400: ")
pct <- round(sections/sum(sections)*100,digits = 1)
labs <- paste(labs, pct,"%, ", sections,sep="")
pie(sections,labels = labs, col=rainbow(4),main="Ploidy of sgRNAs in A375 cell line")
piedata = count(CNVtable$CNVcount)
sections = c(piedata$freq[3:5],piedata$freq[1]+piedata$freq[2]+piedata$freq[6])
labs = c("2x", "3x", "4x", "Other")
#pct <- round(sections/sum(sections)*100,digits = 1)
#labs <- paste(labs,":", pct,"%",sep="")
#labs = c("OS > 400: ", "OS <= 400: ")
pct <- round(sections/sum(sections)*100,digits = 1)
labs <- paste(labs, pct,"%, ", sections,sep="")
pie(sections,labels = labs, col=rainbow(4),main="Ploidy of sgRNAs in A375 cell line")
piedata = count(CNVtable$CNVcount)
sections = c(piedata$freq[3:5],piedata$freq[1]+piedata$freq[2]+piedata$freq[6])
labs = c("2x: ", "3x: ", "4x: ", "Other: ")
#pct <- round(sections/sum(sections)*100,digits = 1)
#labs <- paste(labs,":", pct,"%",sep="")
#labs = c("OS > 400: ", "OS <= 400: ")
pct <- round(sections/sum(sections)*100,digits = 1)
labs <- paste(labs, pct,"%, ", sections,sep="")
pie(sections,labels = labs, col=rainbow(4),main="Ploidy of sgRNAs in A375 cell line")
pie(sections,labels = labs, col=("pink","light blue","green","black"),main="Ploidy of sgRNAs in A375 cell line")
```
pie(sections,labels = labs, col=("pink","light blue","green","black"),main="Ploidy of sgRNAs in A375 cell line")
pie(sections,labels = labs, col=c("pink","light blue","green","black"),main="Ploidy of sgRNAs in A375 cell line")
```
pie(sections,labels = labs, col=c("pink","light blue","dark green","black"),main="Ploidy of sgRNAs in A375 cell line")
pie(sections,labels = labs, col=c("pink","light blue","dark green","white"),main="Ploidy of sgRNAs in A375 cell line")
pie(sections,labels = labs, col=c("pink","light blue","white","black"),main="Ploidy of sgRNAs in A375 cell line")
pie(sections,labels = labs, col=c("pink","orange","light blue","black"),main="Ploidy of sgRNAs in A375 cell line")
pie(sections,labels = labs, col=c("pink","light orange","light blue","black"),main="Ploidy of sgRNAs in A375 cell line")
pie(sections,labels = labs, col=c("pink","light purple","light blue","black"),main="Ploidy of sgRNAs in A375 cell line")
pie(sections,labels = labs, col=c("pink","purple","light blue","black"),main="Ploidy of sgRNAs in A375 cell line")
pie(sections,labels = labs, col=c("pink","light green","light blue","black"),main="Ploidy of sgRNAs in A375 cell line")
sections = c(sum(CNVtable_23x$OS > 400),sum(CNVtable_23x$OS <= 400))
labs = c("OS > 400: ", "OS <= 400: ")
pct <- round(sections/sum(sections)*100,digits = 1)
labs <- paste(labs, pct,"%, ", sections,sep="")
pie(sections,labels = labs, col=c("purple","orange"), main="Off-target Scores of 2x and 3x ploidy sgRNAs")
CNVtable_sub <- CNVtable_sub[order(CNVtable_23x$Ratio_D14),]
CNVtable_sub_parts = CNVtable_sub[1:1000,c(15,17:28)]
df.m <- melt(CNVtable_sub_parts, id.var = "CNVcount")
ggplot(data = df.m, aes(x=variable, y=value)) + geom_boxplot(aes(fill=CNVcount)) + scale_y_log10() + theme_bw()
CNVtable_sub <- CNVtable_sub[order(CNVtable_23x$Ratio_D14),]
CNVtable_sub_parts = CNVtable_sub[,c(15,17:28)]
df.m <- melt(CNVtable_sub_parts, id.var = "CNVcount")
ggplot(data = df.m, aes(x=variable, y=value)) + geom_boxplot(aes(fill=CNVcount)) + scale_y_log10() + theme_bw()
process_CNV_table = function(df){
df$D7R1 = df$norm_count_D7_Rep1/df$norm_count_plasmid
df$D7R2 = df$norm_count_D7_Rep2/df$norm_count_plasmid
df$D14R1 = df$norm_count_D14_Rep1/df$norm_count_plasmid
df$D14R2 = df$norm_count_D14_Rep2/df$norm_count_plasmid
df$PLX7R1 = df$norm_count_PLX7_Rep1/df$norm_count_plasmid
df$PLX7R2 = df$norm_count_PLX7_Rep2/df$norm_count_plasmid
df$PLX14R1 = df$norm_count_PLX14_Rep1/df$norm_count_plasmid
df$PLX14R2 = df$norm_count_PLX14_Rep2/df$norm_count_plasmid
df$D7 = (df$norm_count_D7_Rep1+df$norm_count_D7_Rep2)/(2*df$norm_count_plasmid)
df$D14 = (df$norm_count_D14_Rep1+df$norm_count_D14_Rep2)/(2*df$norm_count_plasmid)
df$PLX7 = (df$norm_count_PLX7_Rep1+df$norm_count_PLX7_Rep2)/(2*df$norm_count_plasmid)
df$PLX14 = (df$norm_count_PLX14_Rep1+df$norm_count_PLX14_Rep2)/(2*df$norm_count_plasmid)
return(df)
}
CNVtable = process_CNV_table(CNVload)
CNVtable_23x = subset(CNVtable, CNVcount > 1 & CNVcount < 4)
CNVtable_sub <- CNVtable_sub[order(CNVtable_23x$Ratio_D14),]
CNVtable_sub <- CNVtable_sub[order(CNVtable_23x$D14),]
CNVtable_sub_parts = CNVtable_sub[,c(15,17:28)]
df.m <- melt(CNVtable_sub_parts, id.var = "CNVcount")
ggplot(data = df.m, aes(x=variable, y=value)) + geom_boxplot(aes(fill=CNVcount)) + scale_y_log10() + theme_bw()
CNVtable_23x = subset(CNVtable, CNVcount > 1 & CNVcount < 4)
CNVtable_sub <- CNVtable_23x[order(CNVtable_23x$D14),]
CNVtable_sub_parts = CNVtable_sub[,c(15,17:28)]
CNVtable_sub_parts = CNVtable_sub[1:1000,c(15,17:28)]
df.m <- melt(CNVtable_sub_parts, id.var = "CNVcount")
ggplot(data = df.m, aes(x=variable, y=value)) + geom_boxplot(aes(fill=CNVcount)) + scale_y_log10() + theme_bw()
CNVtable_sub$CNVcount <- as.character(CNVtable_sub$CNVcount)
CNVtable_sub_parts = CNVtable_sub[,c(15,17:28)]
df.m <- melt(CNVtable_sub_parts, id.var = "CNVcount")
ggplot(data = df.m, aes(x=variable, y=value)) + geom_boxplot(aes(fill=CNVcount)) + scale_y_log10() + theme_bw()
ggplot(data = df.m, aes(x=variable, y=value)) +
geom_boxplot(aes(fill=CNVcount)) + scale_y_log10() +
+ theme_bw(axis.title.y = "Ratio")
ggplot(data = df.m, aes(x=variable, y=value)) +
geom_boxplot(aes(fill=CNVcount)) + scale_y_log10() +
+ theme_bw()
ggplot(data = df.m, aes(x=variable, y=value)) +
geom_boxplot(aes(fill=CNVcount)) + scale_y_log10() +
theme_bw()
ggplot(data = df.m, aes(x=variable, y=value)) +
geom_boxplot(aes(fill=CNVcount)) + scale_y_log10() +
theme_bw(axis.title.x = "t")
ggplot(data = df.m, aes(x=variable, y=value)) +
geom_boxplot(aes(fill=CNVcount)) + scale_y_log10() +
labs(title = "New plot title") + theme_bw(axis.title.x = "t")
ggplot(data = df.m, aes(x=variable, y=value)) +
geom_boxplot(aes(fill=CNVcount)) + scale_y_log10() +
labs(title = "New plot title") + theme_bw()
CNVtable_sub_parts = CNVtable_sub[,c(15,17:24)]
df.m <- melt(CNVtable_sub_parts, id.var = "CNVcount")
ggplot(data = df.m, aes(x=variable, y=value)) +
geom_boxplot(aes(fill=CNVcount)) + scale_y_log10() +
labs(title = "Boxplots showing effect of CNV count across all conditions", x = "Condition", y = "Ratio to Control") + theme_bw()
CNVtable_sub <- CNVtable_sub[order(CNVtable_sub$D14),]
CNVtable_23x$CNVcount = as.character(CNVtable_23x$CNVcount)
CNVtable_sub_parts = CNVtable_23x[,c(15,17:24)]
df.m <- melt(CNVtable_sub_parts, id.var = "CNVcount")
ggplot(data = df.m, aes(x=variable, y=value)) +
geom_boxplot(aes(fill=CNVcount)) + scale_y_log10() +
labs(title = "Boxplots showing effect of CNV count across all conditions", x = "Condition", y = "Ratio to Control") + theme_bw()
ggplot(data = df.m, aes(x=variable, y=value)) + theme_bw() +
geom_boxplot(aes(fill=CNVcount)) + scale_y_log10() +
labs(title = "Boxplots showing effect of CNV count across all conditions",
x = "Condition", y = "Ratio to Control")
CNVtable_sub <- CNVtable_23x[order(CNVtable_23x$D14),]
CNVtable_sub_parts = CNVtable_sub[,c(15,17:20)]
df.m <- melt(CNVtable_sub_parts, id.var = "CNVcount")
ggplot(data = df.m, aes(x=variable, y=value)) +
geom_boxplot(aes(fill=CNVcount)) + scale_y_log10() +
labs(title = "Boxplots showing effect of CNV count across all conditions", x = "Condition", y = "Ratio to Control") + theme_bw()
ggplot(data = df.m, aes(x=variable, y=value)) + theme_bw() +
geom_boxplot(aes(fill=CNVcount)) + scale_y_log10() +
labs(title = "Boxplots showing effect of CNV count across all conditions",
x = "Condition", y = "Ratio to Control")
CNVtable_sub_parts = CNVtable_sub[1:1000,c(15,17:20)]
df.m <- melt(CNVtable_sub_parts, id.var = "CNVcount")
ggplot(data = df.m, aes(x=variable, y=value)) + theme_bw() +
geom_boxplot(aes(fill=CNVcount)) + scale_y_log10() +
labs(title = "Boxplots showing effect of CNV count across all conditions",
x = "Condition", y = "Ratio to Control")
summary(CNVtable_sub)
summary(CNVtable_parts)
summary(CNVtable_sub_parts)
count(CNVtable_sub_parts$CNVcount)
CNVtable_sub_parts = CNVtable_sub[1:500,c(15,17:20)]
df.m <- melt(CNVtable_sub_parts, id.var = "CNVcount")
ggplot(data = df.m, aes(x=variable, y=value)) + theme_bw() +
geom_boxplot(aes(fill=CNVcount)) + scale_y_log10() +
labs(title = "Boxplots showing effect of CNV count across all conditions",
x = "Condition", y = "Ratio to Control")
count(CNVtable_sub_parts$CNVcount)
CNVtable_sub_parts = CNVtable_sub[1:300,c(15,17:20)]
df.m <- melt(CNVtable_sub_parts, id.var = "CNVcount")
ggplot(data = df.m, aes(x=variable, y=value)) + theme_bw() +
geom_boxplot(aes(fill=CNVcount)) + scale_y_log10() +
labs(title = "Boxplots showing effect of CNV count across all conditions",
x = "Condition", y = "Ratio to Control")
count(CNVtable_sub_parts$CNVcount)
CNVtable_sub_parts = CNVtable_sub[1:2000,c(15,17:20)]
df.m <- melt(CNVtable_sub_parts, id.var = "CNVcount")
ggplot(data = df.m, aes(x=variable, y=value)) + theme_bw() +
geom_boxplot(aes(fill=CNVcount)) + scale_y_log10() +
labs(title = "Boxplots showing effect of CNV count across all conditions",
x = "Condition", y = "Ratio to Control")
count(CNVtable_sub_parts$CNVcount)
CNVtable_sub_parts = CNVtable_sub[1:1000,c(15,17:20)]
df.m <- melt(CNVtable_sub_parts, id.var = "CNVcount")
ggplot(data = df.m, aes(x=variable, y=value)) + theme_bw() +
geom_boxplot(aes(fill=CNVcount)) + scale_y_log10() +
labs(title = "Boxplots showing effect of CNV count across all conditions",
x = "Condition", y = "Ratio to Control")
count(CNVtable_sub_parts$CNVcount)
CNVtable_sub_parts = CNVtable_sub[1:700,c(15,17:20)]
df.m <- melt(CNVtable_sub_parts, id.var = "CNVcount")
ggplot(data = df.m, aes(x=variable, y=value)) + theme_bw() +
geom_boxplot(aes(fill=CNVcount)) + scale_y_log10() +
labs(title = "Boxplots showing effect of CNV count across all conditions",
x = "Condition", y = "Ratio to Control")
count(CNVtable_sub_parts$CNVcount)
CNVtable_sub_parts = CNVtable_sub[1:1000,c(15,17:20)]
df.m <- melt(CNVtable_sub_parts, id.var = "CNVcount")
ggplot(data = df.m, aes(x=variable, y=value)) + theme_bw() +
geom_boxplot(aes(fill=CNVcount)) + scale_y_log10() +
labs(title = "Boxplots showing effect of CNV count across all conditions",
x = "Condition", y = "Ratio to Control")
CNVtable_sub <- CNVtable_23x[order(CNVtable_23x$PLX14),]
CNVtable_sub <- CNVtable_23x[order(-CNVtable_23x$PLX14),]
CNVtable_sub <- CNVtable_23x[order(-CNVtable_23x$PLX14),]
CNVtable_sub_parts = CNVtable_sub[1:200,c(15,17:20)]
df.m <- melt(CNVtable_sub_parts, id.var = "CNVcount")
ggplot(data = df.m, aes(x=variable, y=value)) + theme_bw() +
geom_boxplot(aes(fill=CNVcount)) + scale_y_log10() +
labs(title = "Boxplots showing effect of CNV count across all conditions",
x = "Condition", y = "Ratio to Control")
count(CNVtable_sub_parts$CNVcount)
CNVtable_sub_parts = CNVtable_sub[1:200,c(15,21:24)]
df.m <- melt(CNVtable_sub_parts, id.var = "CNVcount")
ggplot(data = df.m, aes(x=variable, y=value)) + theme_bw() +
geom_boxplot(aes(fill=CNVcount)) + scale_y_log10() +
labs(title = "Boxplots showing effect of CNV count across all conditions",
x = "Condition", y = "Ratio to Control")
count(CNVtable_sub_parts$CNVcount)
CNVtable_sub_parts = CNVtable_sub[1:300,c(15,21:24)]
df.m <- melt(CNVtable_sub_parts, id.var = "CNVcount")
ggplot(data = df.m, aes(x=variable, y=value)) + theme_bw() +
geom_boxplot(aes(fill=CNVcount)) + scale_y_log10() +
labs(title = "Boxplots showing effect of CNV count across all conditions",
x = "Condition", y = "Ratio to Control")
CNVtable_sub_parts = CNVtable_sub[1:400,c(15,21:24)]
df.m <- melt(CNVtable_sub_parts, id.var = "CNVcount")
ggplot(data = df.m, aes(x=variable, y=value)) + theme_bw() +
geom_boxplot(aes(fill=CNVcount)) + scale_y_log10() +
labs(title = "Boxplots showing effect of CNV count across all conditions",
x = "Condition", y = "Ratio to Control")
CNVtable_sub_parts = CNVtable_sub[1:500,c(15,21:24)]
df.m <- melt(CNVtable_sub_parts, id.var = "CNVcount")
ggplot(data = df.m, aes(x=variable, y=value)) + theme_bw() +
geom_boxplot(aes(fill=CNVcount)) + scale_y_log10() +
labs(title = "Boxplots showing effect of CNV count across all conditions",
x = "Condition", y = "Ratio to Control")
CNVtable_sub_parts = CNVtable_sub[1:400,c(15,21:24)]
df.m <- melt(CNVtable_sub_parts, id.var = "CNVcount")
ggplot(data = df.m, aes(x=variable, y=value)) + theme_bw() +
geom_boxplot(aes(fill=CNVcount)) + scale_y_log10() +
labs(title = "Boxplots showing effect of CNV count across all conditions",
x = "Condition", y = "Ratio to Control")
ggplot(data = df.m, aes(x=variable, y=value)) + theme_bw() +
geom_boxplot(aes(fill=CNVcount)) + scale_y_log10() +
labs(title = "Boxplots showing effect of CNV count on top 400 increase sgRNAs in PLX",
x = "Condition", y = "Ratio to Control")
ggplot(data = df.m, aes(x=variable, y=value)) + theme_bw() +
geom_boxplot(aes(fill=CNVcount)) + scale_y_log10() +
labs(title = "Boxplots showing effect of CNV count across on 1000 most decreased sgRNAs in Control condition",
x = "Condition", y = "Ratio to Control")
CNVtable_sub <- CNVtable_23x[order(CNVtable_23x$D14),]
CNVtable_sub_parts = CNVtable_sub[1:1000,c(15,17:20)]
df.m <- melt(CNVtable_sub_parts, id.var = "CNVcount")
ggplot(data = df.m, aes(x=variable, y=value)) + theme_bw() +
geom_boxplot(aes(fill=CNVcount)) + scale_y_log10() +
labs(title = "Boxplots showing effect of CNV count across on 1000 most decreased sgRNAs in Control condition",
x = "Condition", y = "Ratio to Control")
fit <- aov(y ~ A, data=CNVtable_sub_parts)
Y <- cbind(CNVtable_sub_parts$D7R1,CNVtable_sub_parts$D7R2,CNVtable_sub_parts$D14R1,CNVtable_sub_parts$D14R2)
fit <- manova(Y ~ CNVtable_sub_parts$CNVcount)
summary(fit, test="Pillai")
Y <- cbind(CNVtable_23x$D7R1,CNVtable_sub_parts$D7R2,CNVtable_sub_parts$D14R1,CNVtable_sub_parts$D14R2)
Y <- cbind(CNVtable_23x$D7R1,CNVtable_23x$D7R2,CNVtable_23x$D14R1,CNVtable_23x$D14R2)
fit <- manova(Y ~ CNVtable_23x$CNVcount)
summary(fit, test="Pillai")
fit <- manova(cbind(D7R1,D7R2,D14R1,D14R2) ~ as.factor(CNVcount), data = CNVtable_23x)
summary(fit, test="Pillai")
summary.aov(fit)
fit <- manova(cbind(norm_count_D7_Rep1,norm_count_D7_Rep2,norm_count_D14_Rep1,norm_count_D14_Rep2) ~ as.factor(CNVcount), data = CNVtable_23x)
summary(fit, test="Pillai")
fit <- manova(cbind(D7R1,D7R2,D14R1,D14R2) ~ as.factor(CNVcount), data = CNVtable_23x)
summary(fit, test="Pillai")
fit <- manova(cbind(norm_count_D7_Rep1,norm_count_D7_Rep2,norm_count_D14_Rep1,norm_count_D14_Rep2) ~ as.factor(CNVcount), data = CNVtable_23x)
summary(fit, test="Wilks")
summary(fit, test="Pillai")
summary(fit, test="Wilks")
fit <- manova(cbind(D7R1,D7R2) ~ as.factor(CNVcount), data = CNVtable_23x)
summary(fit, test="Pillai")
summary(fit, test="Wilks")
fit <- manova(cbind(D14R1,D14R2) ~ as.factor(CNVcount), data = CNVtable_23x)
summary(fit, test="Pillai")
flips=sample(0:1, length(CNVtable_23x), replace=T)
flips=sample(0:1, length(CNVtable_23x[,1]), replace=T)
flips=sample(T:F, length(CNVtable_23x[,1]), replace=T)
flips=sample(T:F, length(CNVtable_23x[,1]), replace=T)
which(flips)
flips<1
fit <- manova(cbind(D14R1,D14R2) ~as.factor(flips<1), data = CNVtable_23x)
summary(fit, test="Pillai")
summary(fit, test="Wilks")
fit <- manova(cbind(D7R1,D7R2,D14R1,D14R2) ~as.factor(flips<1), data = CNVtable_23x)
summary(fit, test="Pillai")
fit <- manova(cbind(D7R1,D7R2,D14R1,D14R2) ~ as.factor(flips<1), data = CNVtable_23x)
summary(fit, test="Pillai")
summary(fit, test="Wilks")
flips=sample(0:1, length(CNVtable_23x[,1]), replace=T)
fit <- manova(cbind(D7R1,D7R2,D14R1,D14R2) ~ as.factor(flips<1), data = CNVtable_23x)
summary(fit, test="Pillai")
summary(fit, test="Wilks")
flips=sample(0:1, length(CNVtable_23x[,1]), replace=T)
fit <- manova(cbind(D7R1,D7R2,D14R1,D14R2) ~ as.factor(flips<1), data = CNVtable_23x)
summary(fit, test="Pillai")
flips=sample(0:1, length(CNVtable_23x[,1]), replace=T)
fit <- manova(cbind(D7R1,D7R2,D14R1,D14R2) ~ as.factor(flips<1), data = CNVtable_23x)
summary(fit, test="Pillai")
flips=sample(0:1, length(CNVtable_23x[,1]), replace=T)
fit <- manova(cbind(D7R1,D7R2,D14R1,D14R2) ~ as.factor(flips<1), data = CNVtable_23x)
summary(fit, test="Pillai")
flips=sample(0:1, length(CNVtable_23x[,1]), replace=T)
fit <- manova(cbind(D7R1,D7R2,D14R1,D14R2) ~ as.factor(flips<1), data = CNVtable_23x)
summary(fit, test="Pillai")
summary(fit, test="Wilks")
flips=sample(0:1, length(CNVtable_23x[,1]), replace=T)
fit <- manova(cbind(D7R1,D7R2,D14R1,D14R2) ~ as.factor(flips<1), data = CNVtable_23x)
summary(fit, test="Pillai")
summary(fit, test="Wilks")
flips=sample(0:1, length(CNVtable_23x[,1]), replace=T)
fit <- manova(cbind(D7R1,D7R2,D14R1,D14R2) ~ as.factor(flips<1), data = CNVtable_23x)
summary(fit, test="Pillai")
fit <- manova(cbind(D7R1,D7R2,D14R1,D14R2) ~ as.factor(CNVcount), data = CNVtable_23x)
summary(fit, test="Pillai")
fit <- manova(cbind(D7R1,D7R2,D14R1,D14R2) ~ as.factor(CNVtable_23x$CNVcount), data = CNVtable_23x)
summary(fit, test="Pillai")
flips=sample(0:1, length(CNVtable_23x[,1]), replace=T)
fit <- manova(cbind(D7R1,D7R2,D14R1,D14R2,PLX7R1,PLX7R2,PLX14R1,PLX14R2) ~ as.factor(CNVtable_23x$CNVcount), data = CNVtable_23x)
summary(fit, test="Pillai")
flips=sample(0:1, length(CNVtable_23x[,1]), replace=T)
fit <- manova(cbind(D7R1,D7R2,D14R1,D14R2,PLX7R1,PLX7R2,PLX14R1,PLX14R2) ~ as.factor(flips), data = CNVtable_23x)
summary(fit, test="Pillai")
summary(fit, test="Wilks")
flips=sample(0:1, length(CNVtable_23x[,1]), replace=T)
fit <- manova(cbind(D7R1,D7R2,D14R1,D14R2,PLX7R1,PLX7R2,PLX14R1,PLX14R2) ~ as.factor(flips), data = CNVtable_23x)
summary(fit, test="Pillai")
summary(fit, test="Wilks")
flips=sample(0:1, length(CNVtable_23x[,1]), replace=T)
fit <- manova(cbind(D7R1,D7R2,D14R1,D14R2,PLX7R1,PLX7R2,PLX14R1,PLX14R2) ~ as.factor(flips), data = CNVtable_23x)
summary(fit, test="Pillai")
summary(fit, test="Wilks")
flips=sample(0:1, length(CNVtable_23x[,1]), replace=T)
fit <- manova(cbind(D7R1,D7R2,D14R1,D14R2,PLX7R1,PLX7R2,PLX14R1,PLX14R2) ~ as.factor(flips), data = CNVtable_23x)
summary(fit, test="Pillai")
summary(fit, test="Wilks")
fit <- manova(cbind(D7R1,D7R2,D14R1,D14R2,PLX7R1,PLX7R2,PLX14R1,PLX14R2) ~ as.factor(CNVtable_23x$CNVcount), data = CNVtable_23x)
summary(fit, test="Pillai")
summary(fit, test="Wilks")
flips=sample(0:1, length(CNVtable_23x[,1]), replace=T)
fit <- manova(cbind(D7R1,D7R2,D14R1,D14R2,PLX7R1,PLX7R2,PLX14R1,PLX14R2) ~ as.factor(flips), data = CNVtable_23x)
summary(fit, test="Pillai")
CNVtable_23x_OSg400 = subset(CNVtable_23x, OS > 400)
CNVtable_23x_OSg400 = subset(CNVtable_23x, OS > 400)
fit <- manova(cbind(D7R1,D7R2,D14R1,D14R2,PLX7R1,PLX7R2,PLX14R1,PLX14R2) ~ as.factor(CNVtable_23x$CNVcount), data = CNVtable_23x_OSg400)
summary(fit, test="Pillai")
CNVtable_23x_OSg400 = subset(CNVtable_23x, OS > 400)
fit <- manova(cbind(D7R1,D7R2,D14R1,D14R2,PLX7R1,PLX7R2,PLX14R1,PLX14R2) ~ as.factor(CNVcount), data = CNVtable_23x_OSg400)
summary(fit, test="Pillai")
fit <- manova(cbind(D7R1,D7R2,D14R1,D14R2,PLX7R1,PLX7R2,PLX14R1,PLX14R2) ~ as.factor(CNVcount), data = CNVtable_23x)
summary(fit, test="Pillai")
CNVtable_23x_OSg400 = subset(CNVtable_23x, OS > 400)
fit <- manova(cbind(D7R1,D7R2,D14R1,D14R2,PLX7R1,PLX7R2,PLX14R1,PLX14R2) ~ as.factor(CNVcount), data = CNVtable_23x_OSg400)
CNVtable_23x_OSg400 = subset(CNVtable_23x, OS > 400)
fit <- manova(cbind(D7R1,D7R2,D14R1,D14R2,PLX7R1,PLX7R2,PLX14R1,PLX14R2) ~ as.factor(CNVcount), data = CNVtable_23x_OSg400)
summary(fit, test="Pillai")
CNVtable_23x_OSg400 = subset(CNVtable_23x, OS > 400)
fit <- manova(cbind(D7R1,D7R2,D14R1,D14R2,PLX7R1,PLX7R2,PLX14R1,PLX14R2) ~ as.factor(CNVcount), data = CNVtable_23x_OSg400)
summary(fit, test="Pillai")
CNVtable_23x_OSg400 = subset(CNVtable_23x, OS <= 400)
fit <- manova(cbind(D7R1,D7R2,D14R1,D14R2,PLX7R1,PLX7R2,PLX14R1,PLX14R2) ~ as.factor(CNVcount), data = CNVtable_23x_OSg400)
summary(fit, test="Pillai")
CNVtable_23x_OSg400 = subset(CNVtable_23x, OS <= 400)
fit <- manova(cbind(D7R1,D7R2,D14R1,D14R2,PLX7R1,PLX7R2,PLX14R1,PLX14R2) ~ as.factor(CNVcount), data = CNVtable_23x_OSg400)
summary(fit, test="Pillai")
summary(fit, test="Wilks")
CNVtable_23x_OSg400 = subset(CNVtable_23x, OS > 400)
fit <- manova(cbind(D7R1,D7R2,D14R1,D14R2,PLX7R1,PLX7R2,PLX14R1,PLX14R2) ~ as.factor(CNVcount), data = CNVtable_23x_OSg400)
summary(fit, test="Pillai")
